<?xml version="1.0"?>
<robot name="pantilt" xmlns:xacro="http://ros.org/wiki/xacro">
  <xacro:macro name="pantilt" params="parent">
	<!-- camera -->
	<!-- Based on: https://answers.ros.org/question/142366/simulating-a-camera-with-a-pan-tilt-unit/ -->
	<!-- i think the pan joint can be deleted-->

<!-- TODO name these what ArbotiX-M controller named them, so we have their values... -->
	
	<!-- pan? -->
	<joint name="head_pan_joint" type="fixed">
	    <axis xyz="0 1 0" />
	    <origin xyz="0.0635 0 1.4224" rpy="0 0 0"/> <!-- you have to measure these relative to parent, given in meters -->
	    <parent link="${parent}"/>
	    <child link="pan_link"/>
	  </joint>

	<!-- tilt? -->
	<joint name="head_tilt_joint" type="revolute">
	    <axis xyz="0 0 1" />
	  <limit lower="-${M_PI/2}" upper="${M_PI/2}"  effort="50" velocity="1"/>
	    <origin xyz="0.0 0 0.08" rpy="0 0 0"/>
	    <parent link="pan_link"/>
	    <child link="pantilt_camera_link"/>
	  </joint>



	<link name="pan_link">
	    <collision>
	      <origin xyz="0 0 0" rpy="0 0 0"/>
	      <geometry>
	    <box size="0.16 0.16 0.01"/>
	      </geometry>
	    </collision>
	    <visual>
	      <origin xyz="0 0 0" rpy="0 0 0"/>
	      <geometry>
		    <box size="0.02 0.02 0.01"/> <!-- 0.16 0.16 0.01 -->
	      </geometry>
	    </visual>
	    <inertial>
	      <mass value="1e-5" />
	      <origin xyz="0 0 0" rpy="0 0 0"/>
	      <inertia ixx="1e-6" ixy="0" ixz="0" iyy="1e-6" iyz="0" izz="1e-6" />
	    </inertial>
	  </link>
	    <gazebo reference="pan_link">
		<material>Gazebo/Yellow</material>
	    </gazebo>

	<link name="pantilt_camera_link">
	    <collision>
	      <origin xyz="0 0 0" rpy="0 0 0"/>
	      <geometry>
	    <box size="0.05 0.05 0.05"/>
	      </geometry>
	    </collision>


	    <visual>
	      <origin xyz="0 0 0" rpy="0 0 0"/>
	      <geometry>
	    <box size="0.05 0.05 0.05"/>
	      </geometry>
	    </visual>

	    <inertial>
	      <mass value="1e-5" />
	      <origin xyz="0 0 0" rpy="0 0 0"/>
	      <inertia ixx="1e-6" ixy="0" ixz="0" iyy="1e-6" iyz="0" izz="1e-6" />
	    </inertial>
	  </link>
	    <gazebo reference="pantilt_camera_link">
		<material>Gazebo/Red</material>
	    </gazebo>

	<transmission name="pan_trans">
	  <type>transmission_interface/SimpleTransmission</type>
	  <joint name="head_tilt_joint"/>
	  <actuator name="camera_pan_unit">
	    <hardwareInterface>EffortJointInterface</hardwareInterface>
	    <mechanicalReduction>1</mechanicalReduction>
	  </actuator>
	</transmission>


	<gazebo>
	  <plugin name="gazebo_ros_control" filename="libgazebo_ros_control.so">
	    <robotNamespace>/aircobot</robotNamespace><!--seems to work-->
	  </plugin>
	</gazebo>
  </xacro:macro>
</robot>
